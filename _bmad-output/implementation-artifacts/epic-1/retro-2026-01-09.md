# Epic 1 Retrospective - Foundation & First Domain

**Date:** 2026-01-09
**Facilitator:** Bob (Scrum Master)
**Epic Status:** Complete (7/7 stories done)

---

## Team Participants

- Alice (Product Owner)
- Bob (Scrum Master) - Facilitator
- Charlie (Senior Dev)
- Dana (QA Engineer)
- Elena (Junior Dev)
- Jongkuk Lim (Project Lead)

---

## Epic Summary

**Epic 1: Foundation & First Domain**

| Metric | Value |
|--------|-------|
| Stories Completed | 7/7 (100%) |
| Total Tests | 163 (78 quilto + 19 swealog + 66 root) |
| Code Review Issues Fixed | ~25 across all stories |
| Production Incidents | 0 |
| Technical Debt Items | 3 (minor, deferred) |

### Stories Delivered

1. **Story 1.1:** Initialize Monorepo Structure - uv workspace with quilto + swealog packages
2. **Story 1.2:** Define DomainModule Interface - Pydantic-validated domain configuration
3. **Story 1.3:** Implement LLM Client Abstraction - Tiered config with 5 providers
4. **Story 1.4:** Create GeneralFitness Base Domain - Schema, vocabulary, expertise
5. **Story 1.5:** Generate Expected Parser Outputs - 93 JSON files from Strong CSV
6. **Story 1.6:** Generate Synthetic Test Data - 50 edge case entries
7. **Story 1.7:** Create Test Fixtures and Accuracy Runner - Infrastructure ready for Parser

---

## What Went Well

### Successes

1. **Clean monorepo structure** - uv workspace scaled smoothly across all stories
2. **Reusable patterns established** - `mock_llm` fixture, `ExerciseEquivalenceChecker`, `is_synthetic()` utility
3. **Test infrastructure first** - Accuracy runner ready before Parser exists
4. **Code review process worked** - Caught issues before they became tech debt
5. **Zero production incidents** - Clean epic delivery

### Breakthrough Moments

- Story 1.1: Established uv workspace pattern
- Story 1.3: Created reusable `mock_llm` fixture used throughout
- Story 1.5: `exercise_equivalences.yaml` approach for semantic comparison
- Story 1.6: `is_synthetic()` utility for filtering test data

---

## Challenges Identified

### Recurring Issues (Found in Multiple Stories)

| Issue | Stories Affected | Root Cause |
|-------|------------------|------------|
| Missing type annotations | 1.1, 1.3, 1.7 | No pre-review checklist |
| Missing test coverage | 1.2, 1.3, 1.5, 1.6 | Definition of Done unclear |
| Export/import issues | 1.2, 1.3, 1.4 | `__init__.py` patterns not documented |
| Missing `py.typed` markers | 1.1 | Not in initial checklist |

### Code Review Patterns

- **ALL 7 stories** required fixes during code review
- Common severity: HIGH (1-2), MEDIUM (3-5) per story
- Review process is working - catching issues before merge

---

## Significant Discovery

### Missing Test Corpus Epic

**Problem Identified:**
- Quilto is domain-agnostic framework
- ALL test data is fitness-specific (Swealog)
- Empty directories indicate intended structure never populated:
  - `generic/edge_cases/` - empty
  - `generic/multilingual/` - empty
  - `multi_domain/entries/` - empty
  - `multi_domain/expected/parser/` - empty
  - `fitness/expected/retrieval/` - empty
  - `fitness/expected/query/` - empty
  - `fitness/entries/human/` - empty

**Impact:**
- Cannot prove Quilto is truly domain-agnostic
- Parser (Epic 2) would only be tested with fitness data
- Retriever/Query flow (Epic 3) has no expected outputs

**Resolution:**
- Create **Epic 1.5 - Test Corpus** (inserted before Epic 2)
- Comprehensive test data for framework validation
- Non-fitness domains to prove domain-agnostic design

---

## Action Items

### 1. Create Epic 1.5 - Test Corpus

| Field | Value |
|-------|-------|
| Owner | SM (Bob) to draft, PM (Alice) to review |
| Priority | HIGH - blocks Epic 2 |
| Deadline | Before Epic 2 kickoff |

**Proposed Stories:**

| Story | Description | Directory |
|-------|-------------|-----------|
| TC-1 | Generic edge cases (malformed, empty, unicode) | `generic/edge_cases/` |
| TC-2 | Generic multilingual corpus (EN, KO, mixed) | `generic/multilingual/` |
| TC-3 | Multi-domain test entries | `multi_domain/entries/` |
| TC-4 | Multi-domain expected parser outputs | `multi_domain/expected/parser/` |
| TC-5 | Retrieval expected outputs (fitness) | `fitness/expected/retrieval/` |
| TC-6 | Query flow expected outputs (fitness) | `fitness/expected/query/` |
| TC-7 | Human-curated fitness entries | `fitness/entries/human/` |

**Non-Fitness Domain Suggestions:**
- Personal journal / diary entries
- Recipe / cooking logs
- Study / learning notes
- Meeting notes / work logs

### 2. Add Pre-Review Checklist and Development Workflow

| Field | Value |
|-------|-------|
| Owner | SM (Bob) |
| Priority | MEDIUM |
| Status | **DONE** |
| Location | `_bmad-output/planning-artifacts/dev-workflow.md` |

**Document Created:** `dev-workflow.md` includes:

1. **Core Principle:** "Validate early, validate often"
2. **During Development:** Run formatting, linting, tests as often as possible
3. **Pre-Review Checklist:** All required checks before code review
4. **Common Issues:** Patterns from Epic 1 to avoid
5. **Validation Commands Reference:** Quick reference for all validation tools

**Key Addition (per Jongkuk Lim):**
- Developers should run `uv run ruff check . && uv run pyright && uv run pytest` frequently during development
- Not just before review - constantly throughout implementation

### 3. Create Project Identity Clarification Document

| Field | Value |
|-------|-------|
| Owner | SM (Bob) |
| Priority | HIGH |
| Status | **DONE** |
| Location | `_bmad-output/planning-artifacts/project-identity.md` |

**Problem Identified:** AI agents and developers frequently conflate "Swealog" with the entire project, leading to:
- Framework code being described as "Swealog-specific"
- Test data being fitness-only when it should be domain-agnostic
- Documentation using wrong terminology

**Document Created:** `project-identity.md` clarifies:
- **Quilto** = The domain-agnostic framework (most code goes here)
- **Swealog** = The fitness application (only fitness domain modules)
- **Quiltr** = Reserved name for future SaaS product
- Decision guide: "Where does this code go?"
- Common mistakes to avoid
- Guidance for AI agents

---

## Technical Debt Carried Forward

| Item | Severity | Source | Notes |
|------|----------|--------|-------|
| Missing `__all__` exports | LOW | Story 1.1 | Deferred - not blocking |
| Unconventional pyrightconfig include | LOW | Story 1.1 | Works, just unusual |
| Missing `[project.license]` | LOW | Story 1.1 | Add when publishing |

---

## Preparation for Next Epic

### Epic 1.5 - Test Corpus (NEW)

**Prerequisites:**
- Epic definition document created
- Stories added to sprint-status.yaml
- Clear acceptance criteria for each test data category

**Dependencies from Epic 1:**
- `ExpectedParserOutput` schema (Story 1.5)
- `is_synthetic()` utility (Story 1.6)
- Exercise equivalences pattern (Story 1.5)

### Epic 2 - Input & Storage (After Epic 1.5)

**Dependencies on Epic 1:**
- `DomainModule` interface (Story 1.2)
- `LLMClient` abstraction (Story 1.3)
- `GeneralFitnessEntry` schema (Story 1.4)
- Test infrastructure (Story 1.7)

**Will Benefit From Epic 1.5:**
- Diverse test data for Parser validation
- Non-fitness domains to prove agnostic design

---

## Key Learnings

1. **Test data deserves its own epic** - Don't assume it will "just happen"
2. **Code review catches issues** - Process is working, keep the rigor
3. **Pre-review checklists prevent common issues** - Types, exports, tests
4. **Infrastructure-first pays off** - Test harness ready before Parser exists
5. **Domain-agnostic claims require domain-agnostic tests** - Prove it with data

---

## Next Steps

1. **Immediate:** Create Epic 1.5 definition with Test Corpus stories
2. **Immediate:** Add pre-review checklist to workflow
3. **Next:** Execute Epic 1.5 - Test Corpus
4. **Then:** Begin Epic 2 - Input & Storage with comprehensive test data

---

## Retrospective Outcome

| Item | Status |
|------|--------|
| Epic 1 Review | Complete |
| Significant Discovery | Epic 1.5 - Test Corpus needed |
| Action Items | 3 captured (1 pending, 2 done) |
| Process Improvements | 2 (dev workflow, project identity) |
| Next Epic Ready | Epic 1.5 defined and ready |

### Action Item Status

| # | Action | Status |
|---|--------|--------|
| 1 | Create Epic 1.5 - Test Corpus | **DONE** - Added to epics.md and sprint-status.yaml |
| 2 | Add Dev Workflow Document | **DONE** - `dev-workflow.md` created |
| 3 | Create Project Identity Document | **DONE** - `project-identity.md` created |

---

*Retrospective facilitated by Bob (Scrum Master)*
*Document generated: 2026-01-09*
